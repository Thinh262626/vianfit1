<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>üõí Thanh To√°n</title>

  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"/>
  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>
  <style>
    body { background: #f5f7fa; }
    .card { border-radius: 12px; }
    .payment-option { cursor: pointer; }
    .payment-option.active { border: 2px solid #0d6efd; }
    .price-small { font-size: 0.9rem; color: #555; }
    .badge-discount { background: #fde047; color: #000; font-weight: 600; }
    .order-summary { background: #fff; border-radius: 12px; padding: 1.25rem; }
    .btn-primary { background: #ff6f00; border: none; }
    .btn-primary:hover { background: #e65c00; }
    .fs-sm { font-size: 0.85rem; }
  </style>
</head>
<body>

  <div class="container py-5">
    <!-- Header / Breadcrumb -->
    <div class="mb-4">
      <nav aria-label="breadcrumb">
        <ol class="breadcrumb bg-transparent p-0">
          <li class="breadcrumb-item"><a href="index.html">Trang ch·ªß</a></li>
          <li class="breadcrumb-item active" aria-current="page">Thanh to√°n</li>
        </ol>
      </nav>
      <h2 class="fw-bold"><i class="fas fa-shopping-cart me-2"></i>Thanh To√°n</h2>
      <p class="text-muted">Ki·ªÉm tra l·∫°i ƒë∆°n h√†ng, ch·ªçn ƒë·ªãa ch·ªâ v√† ph∆∞∆°ng th·ª©c thanh to√°n tr∆∞·ªõc khi ho√†n t·∫•t.</p>
    </div>

    <div class="row gy-4">
      <!-- Left: Form -->
      <div class="col-lg-8">
        <!-- ƒê·ªãa ch·ªâ giao h√†ng -->
        <div class="card mb-4 shadow-sm">
          <div class="card-header d-flex justify-content-between align-items-center">
            <div>
              <strong>ƒê·ªãa ch·ªâ giao h√†ng</strong>
            </div>
            <div>
              <button class="btn btn-sm btn-outline-secondary" id="change-address">Thay ƒë·ªïi</button>
            </div>
          </div>
          <div class="card-body">
            <div id="shipping-info">
              <p class="mb-1"><strong>Ng∆∞·ªùi nh·∫≠n:</strong> Nguy·ªÖn VƒÉn A</p>
              <p class="mb-1"><strong>S·ªë ƒëi·ªán tho·∫°i:</strong> 0912 345 678</p>
              <p class="mb-0"><strong>ƒê·ªãa ch·ªâ:</strong> 123 ƒê∆∞·ªùng ABC, Ph∆∞·ªùng 1, Qu·∫≠n 1, TP. HCM</p>
            </div>
            <!-- Hidden editable form (optional) -->
          </div>
        </div>

        <!-- S·∫£n ph·∫©m trong ƒë∆°n -->
        <div class="card mb-4 shadow-sm">
          <div class="card-header">
            <strong>ƒê∆°n h√†ng c·ªßa b·∫°n</strong>
          </div>
          <div class="card-body">
            <!-- Item 1 -->
             <div id="cart-items"></div>
            <div class="d-flex mb-3 border-bottom pb-3">
              <div style="width:60px; flex-shrink:0;">
                <img src="img/wheyicon.png" alt="S·∫£n ph·∫©m" class="img-fluid rounded">
              </div>
              <div class="flex-grow-1 ms-3">
                <h6 class="mb-1">Vinafit Whey ‚Äì C√† Ph√™ Mocha</h6>
                <div class="d-flex justify-content-between align-items-start">
                  <div>
                    <div class="price-small">1 x</div>
                    <div class="fw-bold">‚Ç´1.249.000</div>
                  </div>
                  <div>
                    <span class="badge bg-secondary">V·ªã c√† ph√™, √≠t ng·ªçt</span>
                  </div>
                </div>
              </div>
            </div>
            <!-- Item 2 (v√≠ d·ª•) -->
            <div class="d-flex mb-3 border-bottom pb-3">
              <div style="width:60px; flex-shrink:0;">
                <img src="img/wheyicon.png" alt="S·∫£n ph·∫©m" class="img-fluid rounded">
              </div>
              <div class="flex-grow-1 ms-3">
                <h6 class="mb-1">Vinafit Whey ‚Äì Chu·ªëi Ch√≠n</h6>
                <div class="d-flex justify-content-between align-items-start">
                  <div>
                    <div class="price-small">1 x</div>
                    <div class="fw-bold">‚Ç´1.249.000</div>
                  </div>
                  <div>
                    <span class="badge bg-secondary">V·ªã chu·ªëi, gi√†u nƒÉng l∆∞·ª£ng</span>
                  </div>
                </div>
              </div>
            </div>
            <!-- Gi·∫£m gi√° / m√£ -->
            <div class="mt-3">
              <label for="coupon" class="form-label">M√£ gi·∫£m gi√°</label>
              <div class="input-group">
                <input type="text" id="coupon" class="form-control" placeholder="Nh·∫≠p m√£ (v√≠ d·ª•: THINHDEPTRAI)">
                <button class="btn btn-outline-primary" id="apply-coupon">√Åp d·ª•ng</button>
              </div>
              <div class="form-text">Nh·∫≠p m√£ ƒë·ªÉ ƒë∆∞·ª£c gi·∫£m th√™m (n·∫øu c√≥).</div>
            </div>
          </div>
        </div>

        <!-- Ph∆∞∆°ng th·ª©c thanh to√°n -->
        <div class="card mb-4 shadow-sm">
          <div class="card-header">
            <strong>Ph∆∞∆°ng th·ª©c thanh to√°n</strong>
          </div>
          <div class="card-body">
            <div class="row gy-3">
              <!-- Th·∫ª t√≠n d·ª•ng -->
              <div class="col-md-6">
                <div class="p-3 border rounded payment-option" data-method="card" id="opt-card">
                  <div class="d-flex align-items-center">
                    <div class="me-3"><i class="fa-regular fa-credit-card fa-2x"></i></div>
                    <div>
                      <div class="fw-bold">Th·∫ª t√≠n d·ª•ng / ghi n·ª£</div>
                      <div class="fs-sm">Visa, Mastercard, JCB</div>
                    </div>
                  </div>
                </div>
              </div>
              <!-- Momo / e-wallet -->
              <div class="col-md-6">
                <div class="p-3 border rounded payment-option" data-method="ewallet" id="opt-ewallet">
                  <div class="d-flex align-items-center">
                    <div class="me-3"><i class="fa-brands fa-vn-pay fa-2x"></i></div>
                    <div>
                      <div class="fw-bold">V√≠ ƒëi·ªán t·ª≠ (Momo/ZaloPay)</div>
                      <div class="fs-sm">Thanh to√°n nhanh, qu√©t m√£</div>
                    </div>
                  </div>
                </div>
              </div>
              <!-- COD -->
              <div class="col-md-6">
                <div class="p-3 border rounded payment-option" data-method="cod" id="opt-cod">
                  <div class="d-flex align-items-center">
                    <div class="me-3"><i class="fa-solid fa-truck-fast fa-2x"></i></div>
                    <div>
                      <div class="fw-bold">Thanh to√°n khi nh·∫≠n h√†ng (COD)</div>
                      <div class="fs-sm">Thanh to√°n tr·ª±c ti·∫øp v·ªõi nh√¢n vi√™n giao</div>
                    </div>
                  </div>
                </div>
              </div>
              <!-- Chuy·ªÉn kho·∫£n -->
              <div class="col-md-6">
                <div class="p-3 border rounded payment-option" data-method="bank" id="opt-bank">
                  <div class="d-flex align-items-center">
                    <div class="me-3"><i class="fa-solid fa-building-columns fa-2x"></i></div>
                    <div>
                      <div class="fw-bold">Chuy·ªÉn kho·∫£n ng√¢n h√†ng</div>
                      <div class="fs-sm">Chuy·ªÉn tr∆∞·ªõc, x√°c nh·∫≠n t·ª± ƒë·ªông</div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="form-text mt-2">Ch·ªçn m·ªôt ph∆∞∆°ng th·ª©c ƒë·ªÉ ti·∫øp t·ª•c.</div>
          </div>
        </div>
      </div>

      <!-- Right: Order summary -->
      <div class="col-lg-4">
        <div class="order-summary shadow-sm">
          <h5 class="mb-3">T√≥m t·∫Øt ƒë∆°n h√†ng</h5>
          <div class="d-flex justify-content-between mb-2">
            <div>Gi√°</div>
            <div id="subtotal-display">‚Ç´2.498.000</div>
          </div>
          <div class="d-flex justify-content-between mb-2">
            <div>Ph√≠ v·∫≠n chuy·ªÉn</div>
            <div id="shipping-fee">‚Ç´0</div>
          </div>
          <div class="d-flex justify-content-between mb-2">
            <div>Gi·∫£m gi√°</div>
            <div id="discount-display">‚Ç´500.000</div>
          </div>
          <hr>
          <div class="d-flex justify-content-between fw-bold fs-5">
            <div>T·ªïng c·ªông</div>
            <div id="total-display">‚Ç´1.998.000</div>
          </div>
          <div class="mt-4">
            <button id="pay-btn" class="btn btn-primary w-100 py-3" disabled>
              Thanh to√°n ngay
            </button>
            <div class="text-center mt-2 fs-sm text-muted">
              B·∫±ng vi·ªác b·∫•m thanh to√°n, b·∫°n x√°c nh·∫≠n ƒë∆°n h√†ng v√† ƒë·ªìng √Ω v·ªõi <a href="#" class="text-decoration-none">ƒëi·ªÅu kho·∫£n</a>.
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Optional: m√¥ ph·ªèng modal th√†nh c√¥ng -->
  <div class="modal fade" id="successModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-sm modal-dialog-centered">
      <div class="modal-content rounded-4">
        <div class="modal-body text-center p-4">
          <i class="fa-solid fa-circle-check text-success fa-3x mb-3"></i>
          <h5 class="mb-2">Thanh to√°n th√†nh c√¥ng!</h5>
          <p class="mb-3">C·∫£m ∆°n b·∫°n ƒë√£ ƒë·∫∑t h√†ng. M√£ ƒë∆°n: <strong>#TL123456</strong></p>
          <a href="index.html" class="btn btn-outline-primary w-100">V·ªÅ trang ch·ªß</a>
        </div>
      </div>
    </div>
  </div>

  <!-- Bootstrap + JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

  <script>
    // Ch·ªçn ph∆∞∆°ng th·ª©c thanh to√°n
    const options = document.querySelectorAll('.payment-option');
    let selectedMethod = null;
    options.forEach(o => {
      o.addEventListener('click', () => {
        options.forEach(x => x.classList.remove('active'));
        o.classList.add('active');
        selectedMethod = o.dataset.method;
        checkReady();
      });
    });

    // √Åp m√£ gi·∫£m gi√° (gi·∫£ l·∫≠p)
    document.getElementById('apply-coupon').addEventListener('click', (e) => {
      e.preventDefault();
      const code = document.getElementById('coupon').value.trim().toUpperCase();
      let discount = 0;
      if (code === 'THINHDEPTRAI') {
        discount = 165000000; // 10%
        document.getElementById('discount-display').innerText = '‚Ç´' + numberWithCommas(discount);
      } else {
        alert('M√£ kh√¥ng h·ª£p l·ªá ho·∫∑c h·∫øt hi·ªáu l·ª±c.');
        document.getElementById('discount-display').innerText = '‚Ç´0';
      }
      recalcTotal(discount);
    });

    function numberWithCommas(x) {
      return x.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ".");
    }

    function recalcTotal(discount) {
      const subtotal = 1650000000; // c·ªë ƒë·ªãnh v√≠ d·ª•
      const shipping = 0;
      const total = subtotal + shipping - discount;
      document.getElementById('total-display').innerText = '‚Ç´' + numberWithCommas(total);
    }

    function checkReady() {
      const payBtn = document.getElementById('pay-btn');
      if (selectedMethod) {
        payBtn.disabled = false;
      } else {
        payBtn.disabled = true;
      }
    }

    // Click thanh to√°n
    document.getElementById('pay-btn').addEventListener('click', () => {
      if (!selectedMethod) {
        alert('Ch·ªçn ph∆∞∆°ng th·ª©c thanh to√°n tr∆∞·ªõc.');
        return;
      }
      // Gi·∫£ l·∫≠p x·ª≠ l√Ω, show modal th√†nh c√¥ng
      const successModal = new bootstrap.Modal(document.getElementById('successModal'));
      successModal.show();
    });
    
  </script>
<script>
  // Load s·∫£n ph·∫©m t·ª´ localStorage
  const cartItems = JSON.parse(localStorage.getItem("cart")) || [];
  const container = document.getElementById("cart-items");

  let subtotal = 0;

  cartItems.forEach(item => {
    const itemTotal = item.quantity * item.price;
    subtotal += itemTotal;

    const html = `
      <div class="d-flex mb-3 border-bottom pb-3">
        <div style="width:60px; flex-shrink:0;">
          <img src="img/wheyicon.png" alt="S·∫£n ph·∫©m" class="img-fluid rounded">
        </div>
        <div class="flex-grow-1 ms-3">
          <h6 class="mb-1">${item.name}</h6>
          <div class="d-flex justify-content-between align-items-start">
            <div>
              <div class="price-small">${item.quantity} x</div>
              <div class="fw-bold">‚Ç´${numberWithCommas(item.price)}</div>
            </div>
            <div>
              <span class="badge bg-secondary">S·ªë l∆∞·ª£ng: ${item.quantity}</span>
            </div>
          </div>
        </div>
      </div>
    `;
    container.innerHTML += html;
  });

  // T√≠nh to√°n gi√° hi·ªÉn th·ªã
  const discount = 0;
  const shipping = 0;
  const total = subtotal + shipping - discount;

  document.getElementById("subtotal-display").innerText = "‚Ç´" + numberWithCommas(subtotal);
  document.getElementById("discount-display").innerText = "‚Ç´" + numberWithCommas(discount);
  document.getElementById("total-display").innerText = "‚Ç´" + numberWithCommas(total);

  function numberWithCommas(x) {
    return x.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ".");
  }
</script>
</body>
</html>
